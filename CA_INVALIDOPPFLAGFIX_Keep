CREATE VIEW MARKETINGOPERATIONS.TEMP_TABLES.CA_INVALIDOPPFLAGFIX_Keep AS
SELECT
DISTINCT opp.ID
,CASE
    WHEN profile.NAME != 'GEN - MKG - Lead Development Rep'
    AND ((LENGTH(opp.AUTHORITY_COMMENTS_C) < 20 OR opp.AUTHORITY_COMMENTS_C IS NULL)
    OR (LENGTH(opp.NEED_COMMENTS_C) < 20 OR opp.NEED_COMMENTS_C IS NULL)
    OR  (LENGTH(opp.TIMEFRAME_COMMENTS_C) < 20 OR opp.TIMEFRAME_COMMENTS_C IS NULL)) THEN 1 ELSE 0 END AS f_Ad_17_ClaimedOpp

FROM MARKETINGOPERATIONS.SFDC.OPPORTUNITY opp
left join MARKETINGOPERATIONS.SFDC.user user
ON opp.CREATED_BY_ID = user.ID
left join MARKETINGOPERATIONS.SFDC.PROFILE profile
ON user.PROFILE_ID = profile.ID
